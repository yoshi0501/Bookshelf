<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h1 class="h2 fw-bold mb-2"><%= @item.name %></h1>
    <p class="text-muted mb-0">
      <span class="font-monospace"><%= @item.item_code %></span>
      <% if @item.company %>
        <span class="ms-3">
          <i class="bi bi-building me-1"></i><%= @item.company.name %>
        </span>
      <% end %>
    </p>
  </div>
  <div class="d-flex gap-2">
    <% if current_user&.internal_admin? %>
      <%= link_to edit_item_path(@item), class: "btn btn-outline-secondary btn-sm" do %>
        <i class="bi bi-pencil me-1"></i><%= t('items.show.edit') %>
      <% end %>
    <% end %>
    <%= link_to items_path, class: "btn btn-outline-primary btn-sm" do %>
      <i class="bi bi-arrow-left me-1"></i><%= t('items.show.back') %>
    <% end %>
  </div>
</div>

<div class="row g-4">
  <div class="col-lg-8">
    <div class="card shadow-sm border-0 mb-4">
      <div class="card-header bg-white border-bottom">
        <h5 class="card-title mb-1 fw-bold">
          <i class="bi bi-info-circle me-2"></i><%= t('items.form.basic_info') %>
        </h5>
        <small class="text-muted"><%= t('items.form.basic_info_desc') %></small>
      </div>
      <div class="card-body">
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label fw-semibold text-muted small mb-1"><%= t('items.form.item_code') %></label>
            <p class="mb-0 fw-medium font-monospace"><%= @item.item_code %></p>
          </div>
          <div class="col-md-6">
            <label class="form-label fw-semibold text-muted small mb-1"><%= t('items.form.name') %></label>
            <p class="mb-0 fw-medium"><%= @item.name %></p>
          </div>
          <div class="col-md-12">
            <label class="form-label fw-semibold text-muted small mb-1"><%= t('items.show.status') %></label>
            <p class="mb-0">
              <% if @item.is_active %>
                <span class="badge bg-success"><%= t('items.status.active') %></span>
              <% else %>
                <span class="badge bg-secondary"><%= t('items.status.inactive') %></span>
              <% end %>
            </p>
          </div>
        </div>
      </div>
    </div>

    <div class="card shadow-sm border-0">
      <div class="card-header bg-white border-bottom">
        <h5 class="card-title mb-1 fw-bold">
          <i class="bi bi-currency-yen me-2"></i><%= t('items.form.price_info') %>
        </h5>
        <small class="text-muted"><%= t('items.form.price_info_desc') %></small>
      </div>
      <div class="card-body">
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label fw-semibold text-muted small mb-1"><%= t('items.form.unit_price') %></label>
            <p class="mb-0 fw-medium">
              <%= number_to_currency(@item.unit_price, unit: "Â¥", precision: 0) %>
            </p>
          </div>
          <div class="col-md-6">
            <label class="form-label fw-semibold text-muted small mb-1"><%= t('items.form.co2_per_unit') %></label>
            <p class="mb-0">
              <% if @item.co2_per_unit.present? %>
                <%= @item.co2_per_unit %> kg
              <% else %>
                <span class="text-muted">-</span>
              <% end %>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-lg-4">
    <div class="card shadow-sm border-0 mb-4">
      <div class="card-header bg-white border-bottom">
        <h5 class="card-title mb-1 fw-bold">
          <i class="bi bi-building me-2"></i><%= t('items.show.selling_company') %>
        </h5>
        <small class="text-muted"><%= t('items.show.selling_company_desc') %></small>
      </div>
      <div class="card-body">
        <% if @item.company %>
          <div class="mb-3">
            <label class="form-label fw-semibold text-muted small mb-1"><%= t('items.form.select_company') %></label>
            <p class="mb-0 fw-medium">
              <i class="bi bi-building me-1"></i><%= @item.company.name %>
            </p>
          </div>
          <div class="mb-0">
            <label class="form-label fw-semibold text-muted small mb-1"><%= t('items.show.company_code') %></label>
            <p class="mb-0 font-monospace"><%= @item.company.code %></p>
          </div>
        <% else %>
          <p class="text-muted mb-0"><%= t('items.show.no_company') %></p>
        <% end %>
      </div>
    </div>

    <% if current_user&.internal_admin? && @item.visible_companies.any? %>
      <div class="card shadow-sm border-0">
        <div class="card-header bg-white border-bottom">
          <h5 class="card-title mb-1 fw-bold">
            <i class="bi bi-shop me-2"></i><%= t('items.form.visible_companies') %>
          </h5>
          <small class="text-muted"><%= t('items.show.visible_companies_desc') %></small>
        </div>
        <div class="card-body">
          <ul class="list-unstyled mb-0">
            <% @item.visible_companies.order(:name).each do |company| %>
              <li class="mb-2">
                <i class="bi bi-check-circle text-success me-2"></i>
                <span class="fw-medium"><%= company.name %></span>
                <% if company.id == @item.company_id %>
                  <span class="badge bg-primary ms-2"><%= t('items.show.selling_company_badge') %></span>
                <% end %>
              </li>
            <% end %>
          </ul>
        </div>
      </div>
    <% end %>
  </div>
</div>
