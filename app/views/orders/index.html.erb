<div class="sm:flex sm:items-center mb-8">
  <div class="sm:flex-auto">
    <h1 class="text-2xl font-bold text-gray-900">Orders</h1>
    <p class="mt-2 text-sm text-gray-700">A list of all orders for your company.</p>
  </div>
  <div class="mt-4 sm:ml-16 sm:mt-0 sm:flex-none flex space-x-3">
    <%= link_to "Export CSV", export_orders_path(format: :csv, order_no: params[:order_no], status: params[:status], date_from: params[:date_from], date_to: params[:date_to]), class: "block rounded-md bg-white px-3 py-2 text-center text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50" %>
    <%= link_to "New Order", new_order_path, class: "block rounded-md bg-indigo-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-indigo-500" %>
  </div>
</div>

<div class="bg-white shadow rounded-lg mb-6 p-4">
  <%= form_with url: orders_path, method: :get, class: "grid grid-cols-1 gap-4 sm:grid-cols-4" do |f| %>
    <div>
      <%= f.label :order_no, "Order No", class: "block text-sm font-medium text-gray-700" %>
      <%= f.text_field :order_no, value: params[:order_no], class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm", placeholder: "Search..." %>
    </div>
    <div>
      <%= f.label :status, class: "block text-sm font-medium text-gray-700" %>
      <%= f.select :status, Order.shipping_statuses.keys.map { |s| [s.titleize, s] }, { include_blank: "All Statuses", selected: params[:status] }, class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" %>
    </div>
    <div>
      <%= f.label :date_from, "From Date", class: "block text-sm font-medium text-gray-700" %>
      <%= f.date_field :date_from, value: params[:date_from], class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" %>
    </div>
    <div>
      <%= f.label :date_to, "To Date", class: "block text-sm font-medium text-gray-700" %>
      <%= f.date_field :date_to, value: params[:date_to], class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" %>
    </div>
    <div class="sm:col-span-4 flex justify-end space-x-3">
      <%= link_to "Clear", orders_path, class: "rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50" %>
      <%= f.submit "Search", class: "rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 cursor-pointer" %>
    </div>
  <% end %>
</div>

<div class="bg-white shadow rounded-lg overflow-hidden">
  <table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-50">
      <tr>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Order No</th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Customer</th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
      </tr>
    </thead>
    <tbody class="bg-white divide-y divide-gray-200">
      <% @orders.each do |order| %>
        <tr>
          <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-indigo-600">
            <%= link_to order.order_no, order_path(order) %>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"><%= order.order_date %></td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"><%= order.customer.center_name %></td>
          <td class="px-6 py-4 whitespace-nowrap">
            <%= render "orders/status_badge", status: order.shipping_status %>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right">
            <%= number_to_currency(order.total_amount, unit: "Â¥", precision: 0) %>
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
            <%= link_to "View", order_path(order), class: "text-indigo-600 hover:text-indigo-900" %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>

<%= render "shared/pagination", pagy: @pagy %>
